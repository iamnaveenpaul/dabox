---
title: Angular 7/8 HttpClient — Building a Service for Sending API Calls and Fetching
  Data
image: "/assets/default-social-image.png"
categories: Angular
---

Throughout this guide, you can learn how to use Angular 7/8 and `HttpClient` to submit HTTP requests or render API calls to remote server RESTful endpoints for data collection.

You could also use the example code either to send requests to third-party API servers, as long as they have CORS allowed or as part of a full-stack software product back-end server with client and server tiers.

Also read:

* [Typed and Full Responses and Headers in Angular 7 HttpClient: Link Header Pagination Example](https://www.techiediaries.com/angular-httpclient-headers-full-response)
* [Angular 7 File Upload with Progress Bar Tutorial and Example](https://www.techiediaries.com/angular-file-upload-progress-bar)

**Prerequisites**

You first need to have a few criteria to complete this tutorial:

Installed node.js and npm. If not, just go to the official website and install the operating system's latest version. You can follow the tutorial on Ubuntu.

A back-end server with a CORS-enabled REST API.

The Angular CLI 8 must also be installed:

`$ npm install -g @angular/cli`

To download packages globally, you may need to apply sudo on debian-based systems or macOS.

If you do not have an Angular 8 project, use the following command to create one:

`$ ng start angular-example-httpclient`

Whether or not you want to add routing and the CSS format you need to use, the CLI will prompt. Press Enter after choosing anything that works for you.

Wait for the project files to be generated by the CLI and install the required dependencies.

**The Angular `HttpClient` Module**

Angular is a complete framework for mobile and desktop client side applications. You do not need to use other external libraries to perform prevalent processes such as requests for HTTP.

Angular contains the [HttpClient](https://angular.io/guide/http) module that allow developers to submit HTTP requests to remote HTTP servers and render API calls.

`HttpClient` is accessible from the `@angular/common/http` package which removes the existing HTTP client from the `@angular/http` package.

We have two standard APIs in web browsers for submitting HTTP requests, the `XMLHttpRequest` interface and the `fetch()` API (only accessible on modern browsers).

The module of `HttpClient` is layered on top of the interface of `XMLHttpRequest`. This covers all of this interface's complexities and provides additional functionalities such as:

* RxJS Obervables,
* requests and responses interceptors,
* requests and responses type,
* Better handling of error,
* Testing support,

And so on..

For the next stage in your Angular 8 project, you must set up the `HttpClient` module.

**Configuring The `HttpClient` Module**

Let's now look how you could customize it in your Angular 8 app after adding `HttpClient`.

You do not have to do anything in addition, you just have to import `HttpClientModule` from the `@angular/common/http` package to include in the main application module `imports` array.

Locate the file `src/app/app.module.ts` and add to the top of the file as the following:

`import { HttpClientModule } from '@angular/common/http';`

Now, provide `HttpClientModule` in the application module's `imports` array and that's it! You can now submit HTTP requests to a third-party API or REST API server at back-end using the `HttpClient` library.

You should create a service during the next step that will encompass the code which communicates to your server.

**Creating an Angular 8 Service**

Forward to establishing `HttpClient` in your application, you will have to build a service that will import `HttpClient` and use this to submit in your application for any HTTP requests that are required.

The service will then be inserted into any component that requires the operation of any HTTP.

Go over to your terminal and begin utilizing Angular CLI 8 to generate a service:

`ng g service api`

This will generate the file `api.service.spec.ts` containing tests and the file `api.service.ts` containing the code of the service.

In this tutorial, you will not add any tests so all the work would be done within the file api.service.ts.

In the example, we assume you have an API server that exposes an endpoint of `www.server.com/api/customers` that returns a set of objects from the customer. The following attributes are available to each customer:

* id,
* firstName,
* lastName,
* email,
* phone,
* city

You will be creating a model for your data (customer) in the next step.

**Creating your Angular Model(s)**

The very first thing you have to do at this stage is to build a class for `Customer` that will be used as a type for each object for customer you want to collect.

The `Customer` class is known as a model.

Using the following command, you need to start generating the Customer model:

`ng generate class customer`

You could also simply use `g` instead of `generate`.

The model file inside the src/app folder will be generated.

The structure we used for basic projects is still ok, but you may need to build a models folder for big projects where you can place your class model(s). Also use feature modules to encapsulate the project's separate parts. For example, you may be able to use a customers module in this project that includes the API service, the customer model or any components then import it into the primary application module.

Going ahead, open the file src/app/customer.ts and do:

```
export class Customer{
    id: number;
    firstName: string;
    lastName: string;
    email: string;
    phone: string;
    city: string;
}
```

The `Customer` class is a user-defined type used to describe a model using built-in TypeScript types such as `number` and `string`.

You must also export the model class using the keyword for `export` TypeScript, as it will be imported from other classes such as the API service or components.

Then, open the file `src/app/api.service.ts` and then import then do the `HttpClient` inject:

```
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';

@Injectable({
  providedIn: 'root'
})
export class ApiService {
  apiURL: string = 'http://www.server.com/api/';

  constructor(private httpClient: HttpClient) {}
}
```

Those are the phases to do when the service file has been opened:

In the constructor of the service, you first need to inject `HttpClient` as a private `httpClient` instance.

Next, you insert the parameter `apiURL` string that stores the remote API server address.

In the next step, you will add methods against the `www.server.com/api/customers` endpoint to create, read, update and delete operations.

**Creating CRUD Methods**

You can now build the CRUD methods after building an Angular service and the class model and inserting `HttpClient` into the application.

Since these methods use the `Customer` Model Class as a type, either for the parameters or the return values, the class must first be imported into the directory of the service:

`import { Customer } from './customer';`

You can then describe the following five ways to create, read, update and delete customers:

```
public createCustomer(customer: Customer){}

public updateCustomer(customer: Customer){}

public deleteCustomer(id: number){}

public getCustomerById(id: number){}

public getCustomers(url?: string){}
```

In the next part, all of these methods will be applied one by one beginning with the `.getCustomers` method which applies the reasoning to get data pages from the server.

Next, we'll do:

* The `.createCustomer` process which takes a customer type parameter and sends it to the server
* The `.updateCustomer` process for updating a customer,
* The `.deleteCustomer` process for deleting a customer by id,
* The `.getCustomerById` process for getting a customer by id.

Fetching Paginated Data from The API Server

The `.getCustomers` process to be used for fetching customers.

You will have to apply the reasoning to get paginated data sets in a real-world scenario, so in this case, you will also see how to get paging details from the server responses headers.

You will need to apply the following variables to your service to store the paging information:

* `firstPage` for storing the first page URL,
* `prevPage` for storing the previous page URL,
* `nextPage` for storing the next page URL,
* `lastPage` for storing the last page URL.

With each response, the variables of prevPage and nextPage are constantly updated.

Implement the following code in your ApiService:

```
public firstPage: string = "";
public prevPage: string = "";
public nextPage: string = "";
public lastPage: string = "";
```

You will now be able to use the.getContacts process. This method's simple version will be:

```
public getContacts(){
    return this.httpClient.get<Customer[]>(`${this.apiURL}/customers`);
}
```

This will generate an `Observable<Customer[]>` in your components to be subscribed to, in order to collect information from the server of the customers.

We use the interpolation operator and back-ticks of TypeScript ${} string to format the URL endpoint.

If you want to gather data pages, as long as your server uses `Link` headers to execute pagination, you need to apply the following code instead:

```
  public getContacts(url?: string){

    if(url){
      return this.httpClient.get<Customer[]>(url,{ observe: 'response' }).pipe(tap(res => {
        this.retrieve_pagination_links(res);
      }));
    }

    return this.httpClient.get<Customer[]>(`${this.apiURL}/customers?page=1`,
    { observe: 'response' }).pipe(tap(res => {
      this.retrieve_pagination_links(res); 
    }));
  }
```

Let's clarify the script. You transfer an additional `url` parameter to the method and then test if the `url` has been transferred inside the body of the method:

If an URL is passed to the method, you will send a request for GET using the method `HttpClient.get`. You must send a GET request to www.server.com/api/customers?page=1 if no parameter is passed, and this corresponds to the first data page.

This way, you could use the .getContacts approach to get the first page of information first and then get the next pages by using the URLs of the prior and next pages you initially get from the first response you got.

You have to draw attention to two issues now:

Firstly, as the second parameter, you transfer the `{observe: 'response'}` to the method `HttpClient.get`. That informs `HttpClient` to return the detailed response with included headers that will enable us to obtain the `Link` header containing the server's paging information.

Secondly, to perform a side effect, you use the [.pipe](https://rxjs-dev.firebaseapp.com/api/index/function/pipe) method to combine multiple operators with the [tap](https://rxjs-dev.firebaseapp.com/api/operators/tap) operator. In the side effect, you use the Angular service's `.retrieve_pagination_links` method to get and parse the `Link` header to retrieve the pagination data.

Next. you need to use two methods to retrieve pagination links in your service:

* The `.parse_link_header` process for the `Link` header parsing,
* When the `Link` header is parsed, the `.retrieve_pagination_links` process for setting pagination links.

This is the `.parse_link_header` method's implementation:

```
  parse_link_header(header) {
    if (header.length == 0) {
      return ;
    }

    let parts = header.split(',');
    var links = {};
    parts.forEach( p => {
      let section = p.split(';');
      var url = section[0].replace(/<(.*)>/, '$1').trim();
      var name = section[1].replace(/rel="(.*)"/, '$1').trim();
      links[name] = url;

    }); 
    return links;
  }
```

This is the `.retrieve_pagination_links` method's implementation:

```
public retrieve_pagination_links(response){
      const linkHeader = this.parse_link_header(response.headers.get('Link'));
      this.firstPage = linkHeader["first"];
      this.lastPage =  linkHeader["last"];
      this.prevPage =  linkHeader["prev"];
      this.nextPage =  linkHeader["next"];
}
```

Now, You've completed the `.getContacts` method implementation.

You will implement the process to get a single customer by id method in the next section.

**Fetching a Single Object by its Identifier**

After the method to collect paginated data sets has been implemented, you are now adding the method to obtain a single customer by id:

```
public getCustomerById(id: number){
    return this.httpClient.get(`${this.apiURL}/customers/${id}`);
}
```

You simply format the URL through your id to a single customer in this process.

You can apply the method to create a customer on the server in this next section.

**Sending a POST Request to the Server**

You will be attaching the `.createCustomer` method in this part, that sends the server a POST request which requires a `customer` type parameter:

```
public createCustomer(customer: Customer){
    return this.httpClient.post(`${this.apiURL}/customers/`,customer);
}
```

Such method calls the `HttpClient.post` which takes the URL and the customer object to send a POST request to the server.

In the next segment, you will see how the server's information can be updated using `HttpClient`.

**Sending a PUT Request to the Server**

You will create the `.updateCustomer` method after creating the method for create customers on the server, which will be used to update the server's customer data:

```
public updateCustomer(customer: Customer){
    return this.httpClient.put(`${this.apiURL}/customers/${customer.id}`,customer);
}
```

This procedure calls to submit a PUT request to the server using the `HttpClient.put` process.

We will include the implementation for the last method to delete data from the API server in the next segment.

**Sending a DELETE Request to the Server**

The last method we need to build is the `.deleteCustomer` method which by its identifier deletes a single customer:

```
public deleteCustomer(id: number){
    return this.httpClient.delete(`${this.apiURL}/customers/${id}`);
}
```

This procedure sends a DELETE query to the server using the method `HttpClient.delete` which takes a parameter of the URL referring to the resource you want to delete.

**Testing the CRUD Methods**

After the Angular service has been created that encapsulates all the methods to send requests for HTTP to the API server. Now, let's use a simple analogy to test these methods. Keep in mind that you need the `/api/customer` endpoint HTTP server.

And when you do have it, open the file `src/app/app.component.ts` and start importing `ApiService` and then inject it into `AppComponent`:

```
import { Component , OnInit } from '@angular/core';
import { ApiService } from './api.service';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent{

  constructor(private apiService: ApiService){}
}
```

Then, within the `.ngOnInit` life-cycle process, add the following:

```
  ngOnInit(){
    this.apiService.getCustomers().subscribe((res)=>{
      this.apiService.getCustomers(this.apiService.nextPage).subscribe((res)=>{
        console.log(res.body);
      });      
    });
```

The first call to the `.getCustomers` process will collect information from the first page and returns an Observable. To send the specific request to the server, you need to subscribe to it.

When you get the first response, you can access the URL of the next page of information from the variable `apiService.nextPage` and use it as a parameter for the second call of the `.getCustomers` process to get the second page and so forth.

Ideally, this can be done by adding first, previous, next and last buttons calling the `.getCustomers` method with the corresponding URLs accessible from variables like `this.apiService.firstPage`, `this.apiService.previousPage`, `this.apiService.nextPage` and `this.apiService.lastPage`.

Finally, create an object for the `customer`:

```
    var customer = {
      "id": 1,
      "firstName": "First name",
      "lastName": "Last name",
      "email": "name@email.com",
      "phone": "(387) 592-6773",
      "city": "City",
      "country": "Country",
      "title": "Title"
    }
```

And then use it to create a customer on the server:

```
this.apiService.createCustomer(customer).subscribe((res)=>{
      console.log("Created a customer");
});
```

The following code can also be used to update the customer:

```
this.apiService.updateCustomer(customer).subscribe((res)=>{
   console.log("Updated the customer");
});
```

You can finally delete the customer by using the following identifier:

```
this.apiService.deleteContact(1).subscribe((res)=>{
      console.log("Deleted a customer");
});
```

Remember that unless you are subscribed to the Observable returned from these methods, API calls will not be sent to the server.

**Conclusion**

You have learned to submit HTTP requests to the server using Angular 7/8 and HttpClient in this tutorial.